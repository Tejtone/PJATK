Zadania przykładowe
1|
Utwórz procedurę, która znajdzie liczbę pracowników dla każdego działu. Jeśli liczba ta będzie niższa
od podanej, wyświetl następujący komunikat: "Dział numer X ma Y pracowników". Na końcu procedury
wyświetl informację o liczbie wyświetlonych komunikatów, a jeśli liczba jest niższa niż liczba
wszystkich działów, daj podwyżkę osobie o nazwie "KING".

Zadania indywidualne
1|
Napisz prosty program w języku Transact-SQL. Zadeklaruj zmienną, przypisz do niej liczbę rekordów
w tabeli Emp i wydrukuj wynik za pomocą instrukcji PRINT - na przykład "Jest 10 pracowników”.
2|
Utwórz procedurę do wstawiania nowych działów. Procedura będzie przyjmowała jako parametry
nazwy i lokalizacji. Numer działu zostanie wygenerowany automatycznie i zwrócony w parametrze
wyjściowym. Procedura powinna sprawdzić, czy dział o podanej nazwie lub lokalizacji już istnieje. Jeśli
tak, nie wstawi nowego rekordu i zgłosi błąd.
3|
Użyj kursora, aby przejrzeć wszystkich pracowników i zmodyfikować ich wynagrodzenia:
● Pracownicy, którzy zarabiają mniej niż 1000, otrzymują 10% podwyżkę wynagrodzenia.
● Pracownicy, którzy zarabiają więcej niż 1500, mają obniżone wynagrodzenie o 10%.
● Wyświetlanie informacji o każdej zmianie wprowadzonej w danych wyjściowych.
4|
Przekształć kod z poprzedniego zadania w procedurę, aby wartości zarobków (1000 i 1500) były
dostarczane jako parametry wejściowe procedury.
5|
Utwórz procedurę umożliwiającą wstawianie nowych pracowników do tabeli EMP. W parametrach
podaj:
● nazwa działu
● nazwisko pracownika
Przed wprowadzeniem nowego rekordu procedura powinna sprawdzić, czy istnieje dokładnie jeden
dział o podanej nazwie (jeśli nie, należy zgłosić błąd).
Znajdź wartości dla pozostałych kolumn:
● Job - znajdź nazwę stanowiska z największą liczbą pracowników.
● Sal - oblicz wynagrodzenie równe płacy minimalnej w danym dziale
● Empno - bieżące maksymalne empno + 1
● Deptno - identyfikator działu o nazwie podanej w parametrze
6|
W procedurze znajdź średnią pensję w dziale określonym przez parametr. Przydziel prowizję (comm)
tym pracownikom (w ramach podanego działu), którzy zarabiają poniżej średniej. Prowizja powinna
być równa 5% ich miesięcznego wynagrodzenia.

Zadania dodatkowe
1|
Utwórz procedurę, która oblicza i przydziela roczną premię dla pracowników na podstawie ich
wynagrodzenia, stanowiska i wydajności działu.
1. Procent premii powinien zostać określony w następujący sposób:
○ Kierownicy (MANAGER) otrzymują 15% swojego wynagrodzenia jako premię.
○ Analitycy (ANALYST) otrzymują 12% swojego wynagrodzenia.
○ Sprzedawcy (SALESMAN) otrzymują 10% swojego wynagrodzenia plus 5% prowizji (jeśli
dotyczy).
○ Urzędnicy (CLERK) i inne stanowiska otrzymują 8% swojego wynagrodzenia.
2. Działy o wysokich wynikach (średnie wynagrodzenie > 3000) powinny otrzymać 5% dodatkowej
premii.
3. Bonus powinien zostać zapisany w nowej tabeli o nazwie BONUS_HISTORY.
4. Procedura powinna obejmować obsługę błędów w przypadku, gdy pracownik nie istnieje lub nie ma
ważnego wynagrodzenia.
CREATE TABLE BONUS_HISTORY (
ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
EMPNO NUMBER(4) NOT NULL,
ENAME VARCHAR2(10),
JOB VARCHAR2(9),
DEPTNO NUMBER(2),
SAL NUMBER(7,2),
COMM NUMBER(7,2),
BONUS_AMOUNT NUMBER(7,2),
BONUS_DATE DATE DEFAULT SYSDATE );
